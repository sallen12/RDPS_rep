# RDPS (replication material)

This repository contains `R` code to reproduce the results in the pre-print  

> S. Allen, E. Pescara, and J. Ziegel (2025). 
> Residual Distribution Predictive Systems.
> ArXiv preprint [arXiv:2510.26914](https://arxiv.org/abs/2510.26914)

## Residual Distribution Predictive Systems

The above paper introduces _Residual Distribution Predictive Systems_.

Predictive systems are sets of probabilistic forecasts for real-valued outcomes. Residual Distribution Predictive Systems are constructed using a forecasting procedure that takes a point prediction for the new outcome, and then dresses this prediction using residuals from a training dataset. This forecasting procedure is in-sample calibrated, and hence the Residual Distribution Predictive System is guaranteed to contain an out-of-sample calibrated forecast distribution. This holds for any point predictions, though better point predictions yield more informative forecasts.

Residual Distribution Predictive Systems are similar in essence to _Conformal Predictive Systems_. 
- In a split conformal setting, Residual Distribution Predictive Systems correspond to Conformal Predictive Systems with a particular class of conformity measures that is commonly employed in practice. This provides an alternative perspective on Conformal Predictive Systems.
- In a full conformal setting, the two approaches differ. Residual Distribution Predictive Systems have the advantage that they do not depend on conformity measures that satisfy a fairly stringent monotonicity condition, as is the case for Conformal Predictive Systems. However, in practice, they can correspond to sets of probabilistic forecasts that are too large to be practically useful; this can be circumvented by using robust point predictions.

The two approaches perform similarly in practice when assessed via their ability to issue informative and reliable prediction intervals.

This repository provides the functionality to implement Residual Distributional Predictive Systems and Conformal Predictive Systems based on ordinary least squares regression and kernel ridge regression as point prediction methods.

## Code

The simulation study results can be obtained by sourcing the `sim_main.R` file. Utility functions for the analysis and plotting are provided in the `sim_utils.R` and `sim_plots.R` files. The data used in this study is a simple simulated dataset that is produced in `sim_main.R`. 

To prevent the need to refit the predictive systems, which is quite computationally expensive, the saved predictive systems are available in the Results folder. The plots corresponding to these results can be generated by setting `load <- T` in `sim_main.R`.

 
